import{r as n,j as e,u as C,R as I}from"./index-Fcc6iFca.js";import{u as E}from"./useQuery-Dx68ktIu.js";import{u as L,S as b}from"./SkeletonMovieCard-DHXYrTCm.js";import{g as R,a as T,b as M,B as v,I as $,V as P,c as _,d as W,e as B}from"./VideoModal-DFfa69Df.js";import"./useBaseQuery-CyO_0kK8.js";const H=()=>{const s=E({queryKey:["trendingMovies"],queryFn:R,select:a=>({...a,results:a.results.slice(0,10)})}),t=L({queryKey:["newReleaseMovies"],queryFn:({pageParam:a=1})=>T(a),getNextPageParam:a=>{if(a.page<a.total_pages)return a.page+1},initialPageParam:1}),l=()=>{t.fetchNextPage()};return{trendingMovies:s.data?.results||[],newReleaseMovies:V(t.data?.pages.flatMap(a=>a.results)||[]),loading:s.isLoading||t.isLoading,error:s.error?.message||t.error?.message||null,loadMoreMovies:l,hasMoreMovies:t.hasNextPage}};function V(s){const t=new Set;return s.filter(l=>t.has(l.id)?!1:(t.add(l.id),!0))}const q=({items:s,interval:t=5e3,children:l,paused:a=!1})=>{const[o,d]=n.useState(0),[u,m]=n.useState(!1);return n.useEffect(()=>{if(s.length>0&&!a){const g=setInterval(()=>{m(!0),setTimeout(()=>{d(c=>(c+1)%s.length),m(!1)},200)},t);return()=>clearInterval(g)}return()=>{}},[s.length,t,a]),e.jsx("div",{className:"relative w-full h-full",children:e.jsx("div",{className:`flex transition-opacity duration-500 ${u?"opacity-0":"opacity-100"}`,children:l(s[o],o)})})},k=({movie:s,size:t="medium",trendingRank:l=0})=>{const a=C(),o={small:"text-xs",medium:"text-sm",large:"text-lg"},d=()=>{a(`/movie/${s.id}`)};return e.jsxs("div",{className:"relative group cursor-pointer",onClick:d,children:[e.jsx("div",{className:"relative overflow-hidden rounded-lg aspect-[2/3] mb-2",children:e.jsx("img",{src:M(s.poster_path),alt:s.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"})}),e.jsx("h3",{className:`font-medium ${o[t]} line-clamp-1 group-hover:text-primary-300 transition-colors`,children:s.title}),e.jsxs("div",{className:"text-md text-neutral-400",children:["â­ ",s.vote_average.toFixed(1),"/10"]}),l>0&&e.jsx("div",{className:"absolute top-3 left-3 z-10 w-12 h-12 rounded-full bg-neutral-950/60 flex items-center justify-center text-neutral-25 text-lg font-semibold",children:e.jsx("span",{children:l})})]})},F=({movie:s,isModalOpen:t,setIsModalOpen:l})=>{const a=C(),[o,d]=n.useState(!1),[u,m]=n.useState(null),g=async()=>{if(s.trailer_key){m(s.trailer_key),l(!0);return}d(!0);try{const c=await _(s.id);c&&(m(c),l(!0))}catch(c){console.error("Error playing trailer:",c)}finally{d(!1)}};return e.jsxs("div",{className:"relative w-full mb-12 ",children:[e.jsxs("div",{className:"relative w-full h-160 md:h-[32rem] lg:h-[50rem]",children:[e.jsx("div",{className:"absolute inset-0 bottom-0 bg-gradient-to-t from-black via-black/70 md:via-black/50 to-transparent z-10"}),e.jsx("img",{src:M(s.backdrop_path,"w1280"),alt:s.title,className:"w-full h-96 md:h-[32rem] lg:h-[50rem] object-cover object-center",loading:"lazy"}),e.jsxs("div",{className:"absolute inset-0 z-20 w-full flex flex-col justify-end pb-12 md:pb-16 lg:pb-20 px-4 md:px-15 lg:px-25 xl:px-35 text-white max-w-4xl ",children:[e.jsx("h1",{className:"text-3xl md:text-5xl font-bold mb-3 drop-shadow-lg leading-tight",children:s.title}),e.jsx("p",{className:"text-base md:text-lg text-neutral-400 drop-shadow-md mb-6 leading-relaxed max-w-2xl",children:s.overview}),e.jsxs("div",{className:"flex flex-col gap-3 w-full md:flex-row md:gap-4",children:[e.jsx(v,{variant:"primary",size:"lg",icon:e.jsx($,{size:24}),onClick:g,disabled:o,className:"w-full md:w-1/2 md:max-w-57.5",children:o?"Loading...":"Watch Trailer"}),e.jsx(v,{variant:"secondary",size:"lg",onClick:()=>a(`/movie/${s.id}`),className:"w-full md:w-1/2 md:max-w-57.5",children:"See Detail"})]})]})]}),u&&e.jsx(P,{isOpen:t,onClose:()=>l(!1),videoId:u})]})},N=({direction:s,onClick:t,disabled:l})=>{const a=s==="prev",o=a?W:B,d=a?"left-0 -translate-x-12":"right-0 translate-x-12";return e.jsx("button",{onClick:t,className:`absolute top-1/2 -translate-y-1/2 ${d} bg-neutral-800/80 hover:bg-neutral-700/80 rounded-full p-2 transition-colors z-20 cursor-pointer`,disabled:l,"aria-label":`${s==="prev"?"Previous":"Next"} movies`,children:e.jsx(o,{size:24})})},y=()=>{if(typeof window>"u")return 5;const s=window.innerWidth;return s<768?2:s<1024?3:s<1280?4:5},G=({movies:s})=>{const[t,l]=n.useState(y()),[a,o]=n.useState(0),d=Math.min(s.length,20),u=s.slice(0,d),m=12,g=16,[c,h]=n.useState(m);n.useEffect(()=>{function r(){window.innerWidth>=768?h(g):h(m)}return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]);const p=`calc((100% - ${c*(t-1)}px) / ${t})`,i=d<=t?0:d-t,x=Math.min(a,i),S=()=>{o(r=>r===0?i:r-1)},f=I.useCallback(()=>{o(r=>r===i?0:r+1)},[i]);n.useEffect(()=>{const r=setInterval(()=>{f()},3e3);return()=>clearInterval(r)},[f]),n.useEffect(()=>{function r(){l(y())}return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]);const z=`-${x*(100/t)}%`;return e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"overflow-hidden w-full",children:e.jsx("div",{className:"flex gap-3 md:gap-4 transition-transform duration-500",style:{transform:`translateX(${z})`},children:u.map((r,j)=>e.jsx("div",{className:"flex-shrink-0",style:{width:p},children:e.jsx(k,{movie:r,size:"large",trendingRank:j+1})},r.id))})}),e.jsx(N,{direction:"prev",onClick:S,disabled:!1}),e.jsx(N,{direction:"next",onClick:f,disabled:!1})]})},K=()=>e.jsxs("div",{className:"relative w-full h-[calc(100vh-80px)] overflow-hidden animate-pulse",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-800"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 sm:p-8 lg:p-12 xl:p-16",children:e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("div",{className:"h-12 md:h-16 bg-gray-700 rounded w-3/4 mb-4"}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsx("div",{className:"h-4 bg-gray-700 rounded w-full"}),e.jsx("div",{className:"h-4 bg-gray-700 rounded w-5/6"}),e.jsx("div",{className:"h-4 bg-gray-700 rounded w-4/6"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"h-12 w-40 bg-gray-700 rounded-full"}),e.jsx("div",{className:"h-12 w-40 bg-gray-700 rounded-full"})]})]})})]}),U=()=>{const{trendingMovies:s,newReleaseMovies:t,loading:l,error:a,hasMoreMovies:o,loadMoreMovies:d}=H(),[u,m]=n.useState(!1),[g,c]=n.useState(5),[h,w]=n.useState(2);n.useEffect(()=>{function i(){const x=window.innerWidth;x<640||x<768?c(2):x<1024?c(3):x<1280?c(4):c(5)}return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]);const p=t.slice(0,h*g);return l?e.jsxs("div",{className:"mx-auto",children:[e.jsx(K,{}),e.jsxs("section",{className:"px-4 sm:px-15 lg:px-25 xl:px-35 mb-8 md:mb-12",children:[e.jsx("div",{className:"h-10 bg-gray-700 rounded w-48 mb-4 md:mb-6 animate-pulse"}),e.jsx("div",{className:"flex gap-3 overflow-hidden",children:[...Array(6)].map((i,x)=>e.jsx("div",{className:"min-w-[150px]",children:e.jsx(b,{size:"small"})},x))})]}),e.jsxs("section",{className:"px-4 sm:px-15 lg:px-25 xl:px-35",children:[e.jsx("div",{className:"h-10 bg-gray-700 rounded w-48 mb-4 md:mb-6 animate-pulse"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-4",children:[...Array(10)].map((i,x)=>e.jsx(b,{size:"large"},x))})]})]}):a?e.jsxs("div",{children:["Error: ",a]}):e.jsxs("div",{className:"mx-auto",children:[s.length>0&&e.jsx(q,{items:s,paused:u,children:i=>e.jsx(F,{movie:i,isModalOpen:u,setIsModalOpen:m})}),e.jsxs("section",{className:"px-4 sm:px-15 lg:px-25 xl:px-35 mb-8 md:mb-12",children:[e.jsx("div",{className:"flex items-center justify-between mb-4 md:mb-6",children:e.jsx("h2",{className:"text-display-lg font-bold pb-2",children:"Trending Now"})}),e.jsx(G,{movies:s.slice(0,20)})]}),e.jsx("section",{className:"px-4 sm:px-15 lg:px-25 xl:px-35",children:e.jsxs("div",{className:"relative",children:[e.jsx("h2",{className:"text-display-lg font-bold mb-4 md:mb-6 pb-2",children:"New Release"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-4",children:p.map(i=>e.jsx(k,{movie:i,size:"large"},`new-${i.id}`))}),o&&e.jsx("div",{className:"w-full h-[200px] md:h-[400px] absolute bottom-0 left-0 bg-gradient-to-t from-black via-black/50 to-transparent flex items-center justify-center z-50",children:e.jsx(v,{variant:"secondary",className:"translate-y-5 md:translate-y-10 shadow-2xl",onClick:()=>{w(i=>i+2),d()},children:"Load More"})})]})})]})};export{U as Homepage,U as default};
