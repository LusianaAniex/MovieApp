import{b as j,r as u,j as e}from"./index-Fcc6iFca.js";import{u as y,S as N}from"./SkeletonMovieCard-DHXYrTCm.js";import{s as M,B as w,V as R,c as S}from"./VideoModal-DFfa69Df.js";import{L as b}from"./LargeMovieCard-q3UXYIS2.js";import"./useBaseQuery-CyO_0kK8.js";const L=()=>{const[l]=j(),t=l.get("q")||"",s=y({queryKey:["searchMovies",t],queryFn:({pageParam:r=1})=>M(t,r),enabled:!!t&&/[a-zA-Z0-9]/.test(t),getNextPageParam:r=>{if(r.page<r.total_pages)return r.page+1},initialPageParam:1}),n=()=>{s.fetchNextPage()},i=P(s.data?.pages.flatMap(r=>r.results)||[]),o=s.data?.pages[0]?.total_results||0,c=s.hasNextPage;return{query:t,searchResults:i,totalResults:o,loading:s.isLoading,error:s.error?.message||null,hasMoreResults:c,loadMoreResults:n}};function P(l){const t=new Set;return l.filter(s=>t.has(s.id)?!1:(t.add(s.id),!0))}const C=()=>{const{searchResults:l,loading:t,error:s,hasMoreResults:n,loadMoreResults:i}=L(),[o,c]=u.useState(null),[r,h]=u.useState(!1),[f,m]=u.useState(!1),p=l&&l.length===0&&!t&&!s,x=l?l.filter(a=>a.vote_average>1):[],g=()=>{i()},v=async a=>{m(!0);const d=await S(a);c(d),h(!0),m(!1)};return e.jsxs("div",{className:"mx-auto p-8 mt-20 flex flex-col items-center justify-center min-h-[80vh]",children:[t&&e.jsx("div",{className:"w-full max-w-4xl",children:[...Array(3)].map((a,d)=>e.jsx("div",{className:"mb-8",children:e.jsx(N,{size:"large"})},d))}),s&&e.jsx("p",{className:"text-red-500",children:s}),p&&e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("img",{src:"/data-not-foundpng.png",alt:"Data Not Found",className:"w-[200px] h-[200px] mb-6"}),e.jsx("div",{className:"text-md font-semibold text-white mb-2",children:"Data Not Found"}),e.jsx("div",{className:"text-md font-normal text-neutral-400",children:"Try other keywords"})]}),x.length>0&&e.jsxs("div",{className:"w-full flex flex-col items-center",children:[x.map(a=>e.jsx(b,{posterPath:a.poster_path,title:a.title,voteAverage:a.vote_average,overview:a.overview,onWatchTrailer:()=>v(a.id),trailerAvailable:!f,id:a.id},a.id)),n&&e.jsx("div",{className:"w-full flex items-center justify-center mt-6",children:e.jsx(w,{variant:"secondary",className:"shadow-2xl",onClick:g,disabled:t,children:"Load More"})})]}),e.jsx(R,{isOpen:r&&!!o,onClose:()=>h(!1),videoId:o||""})]})};export{C as default};
